<!DOCTYPE html>
<html lang="en">
<head>
    <script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
        <meta charset="UTF-8">
    <title>Shorten-URL</title>
</head>
<body>
<script>
    function createOnClick() {
        let param = $('input[name=url]').val();
        let object = {destination: param};
        $.ajax({
            type: 'post',
            url: '/url',
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify(object), //문자열로 변환
            //dataType: 'json', 왜 지워야하지???
            success: function (result) {
                //$('input[name=url]').attr(value, result); value에 값이 들어가지만 Input태그는 처음 페이지가 로드될떄만 표시됨
                let newUrl = window.location.protocol+"//"+window.location.host+"/"+result;
                document.querySelector("#url").value = newUrl;
            },
            error: function (msg) {
                console.log()
                console.log(msg);
            }
        });
    }
    function searchOnClick(){
        let param = $('input[name=destination]').val();
        $.ajax({
            type: 'get',//데이터 전송 타입
            url: '/url',//데이터를 주고받을 파일 주소 입력
            contentType: 'application/json;charset=utf-8',
            data: param,
            dataType: 'text',
            success: function() {
               alert("성공");
            }
        });
    }
</script>

<h3>단축URL생성하기</h3>
<input type="text" id="url" name="url" size="80">
    <button type="button" id="create" onclick="createOnClick()">create</button><br>

<h3>단축URL원본찾기</h3>
<input type="text" id= "destination" name="destination" size="80">
    <button type="button" id="search" onclick="searchOnClick()">search</button><br>
</body>
</html>