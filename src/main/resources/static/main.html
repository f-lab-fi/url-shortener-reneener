<!DOCTYPE html>
<html lang="en">
<head>
    <script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
        <meta charset="UTF-8">
    <title>Shorten-URL</title>
</head>
<body>
<script>
    function createOnClick() {
        let param = $('input[name=url]').val();
        let destination = {destination: param};
        $.ajax({
            type: 'post',
            url: '/url',
            contentType: 'application/json;charset=utf-8',
            data: JSON.stringify(destination), //문자열로 변환
            success: function (result) {
               let newUrl = window.location.protocol+"//"+window.location.host+"/"+result;
                document.querySelector("#url").value = newUrl;

            },
            error: function (msg) {
                console.log(msg);
            }
        });
    }

    function searchOnClick(){
        let param = document.querySelector("#destination").value.split("/").reverse()[0];
        $.ajax({
            type: 'get',
            url: "/search/"+param,
            contentType: 'application/json;charset=utf-8',
            success: function(result) {
                console.log(result);
                document.querySelector("#destination").value = result;
            },
            error: function (msg) {
                console.log(msg);
            }
        });
    }
</script>

<h3>단축URL생성하기</h3>
<input type="text" id="url" name="url" size="80">
    <button type="button" id="create" onclick="createOnClick()">create</button><br>

<h3>단축URL원본찾기</h3>
<input type="text" id= "destination" name="destination" size="80">
    <button type="button" id="search" onclick="searchOnClick()">search</button><br>
</body>
</html>